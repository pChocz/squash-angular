<div class="main-content" *ngIf="seasonScoreboard; else loading">

    <!-- <h1>Season ID: {{this.uid}}</h1> -->
    <h1>
        Season Scoreboard

        <button mat-icon-button color="primary" class="align-center margin-left"
            [disabled]="seasonScoreboard.previousSeasonUuid === null"
            [routerLink]="['/season', seasonScoreboard.previousSeasonUuid]">
            <mat-icon>keyboard_arrow_left</mat-icon>
        </button>

        <button mat-icon-button color="primary" class="align-center margin-left"
            [disabled]="seasonScoreboard.nextSeasonUuid === null"
            [routerLink]="['/season', seasonScoreboard.nextSeasonUuid]">
            <mat-icon>keyboard_arrow_right</mat-icon>
        </button>

    </h1>

    <span class="non-break-large">
        Season: <b>{{seasonScoreboard.season.seasonNumber}}</b> <span class="separator">|</span>
    </span>
    <span class="non-break-large">
        Start date: <b>{{dateFormatted(seasonScoreboard.season.seasonStartDate)}}</b> <span class="separator">|</span>
    </span>
    <span class="non-break-large">
        League: <b>{{seasonScoreboard.season.leagueName}}</b> <span class="separator">|</span>
    </span>
    <span class="non-break-large">
        Counted rounds: <b>{{seasonScoreboard.countedRounds}}/{{seasonScoreboard.finishedRounds}}</b>
    </span>

    <mat-button-toggle-group name="fontStyle" aria-label="Font Style" class="button-toggle-full">

        <mat-button-toggle value="r1" style="width:100%" *ngFor="let round of seasonScoreboard.rounds"
            routerLink="/round/{{round.roundUuid}}">
            R{{round.roundNumber}}
        </mat-button-toggle>

        <!-- <mat-button-toggle value="r1" class="custom-button" *ngIf="seasonScoreboard.rounds.length < 10"
            routerLink="/new-round/{{seasonScoreboard.season.seasonUuid}}/{{seasonScoreboard.rounds.length + 1}}">
            + Round
        </mat-button-toggle> -->

    </mat-button-toggle-group>

</div>

<div class="table-content-standalone mat-elevation-z3" [ngClass]="seasonScoreboard !== null ? 'visible': 'hidden'">

    <table mat-table [dataSource]="dataSource" matSort matSortStart="desc">

        <ng-container matColumnDef="position">
            <th mat-header-cell *matHeaderCellDef class="even-distributed left-aligned-cell first-cell-in-row"> P </th>
            <td mat-cell *matCellDef="let row; index as i" class="even-distributed left-aligned-cell first-cell-in-row">
                {{i+1}} </td>
        </ng-container>

        <ng-container matColumnDef="player">
            <th mat-header-cell *matHeaderCellDef> Player </th>
            <td mat-cell *matCellDef="let row"> {{row.player.username}} </td>
        </ng-container>

        <ng-container *ngFor="let item of [].constructor(10); let i = index" matColumnDef="r{{i+1}}">
            <th mat-header-cell *matHeaderCellDef mat-sort-header arrowPosition='before' class="even-distributed right-aligned-cell"> R{{i+1}} </th>
            <td mat-cell *matCellDef="let row" class="even-distributed right-aligned-cell">
                {{row.roundNumberToXpMapAll[i+1]}}
            </td>
        </ng-container>

        <ng-container matColumnDef="totalPoints">
            <th mat-header-cell *matHeaderCellDef mat-sort-header arrowPosition='before'
                class="even-distributed right-aligned-cell"> <b>TOT</b> </th>
            <td mat-cell *matCellDef="let row" class="even-distributed right-aligned-cell"> <b>{{row.totalPoints}}</b>
            </td>
        </ng-container>

        <ng-container matColumnDef="countedPoints">
            <th mat-header-cell *matHeaderCellDef mat-sort-header arrowPosition='before'
                class="even-distributed right-aligned-cell"> <b>CNT</b> </th>
            <td mat-cell *matCellDef="let row" class="even-distributed right-aligned-cell"> <b>{{row.countedPoints}}</b>
            </td>
        </ng-container>

        <ng-container matColumnDef="attendices">
            <th mat-header-cell *matHeaderCellDef mat-sort-header arrowPosition='before'
                class="even-distributed right-aligned-cell"> <b>ATT</b> </th>
            <td mat-cell *matCellDef="let row" class="even-distributed right-aligned-cell"> {{row.attendices}} </td>
        </ng-container>

        <ng-container matColumnDef="average">
            <th mat-header-cell *matHeaderCellDef mat-sort-header arrowPosition='before'
                class="even-distributed right-aligned-cell"> <b>AVG</b> </th>
            <td mat-cell *matCellDef="let row" class="even-distributed right-aligned-cell"> {{row.average}} </td>
        </ng-container>

        <ng-container matColumnDef="bonusPoints">
            <th mat-header-cell *matHeaderCellDef mat-sort-header arrowPosition='before'
                class="even-distributed right-aligned-cell"> <b>BON</b> </th>
            <td mat-cell *matCellDef="let row" class="even-distributed right-aligned-cell"> {{row.bonusPoints}} </td>
        </ng-container>

        <ng-container matColumnDef="countedPointsPretenders">
            <th mat-header-cell *matHeaderCellDef mat-sort-header arrowPosition='before'
                class="even-distributed right-aligned-cell last-cell-in-row"> <b>PRT</b> </th>
            <td mat-cell *matCellDef="let row" class="even-distributed right-aligned-cell last-cell-in-row">
                {{row.countedPointsPretenders}}
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

</div>

<mat-divider class="divider-margin" *ngIf="seasonScoreboard"></mat-divider>

<div class="main-content" *ngIf="seasonScoreboard">

    <span class="non-break-small">
        <b>TOT</b> - Total Points <span class="separator">|</span>
    </span>

    <span class="non-break-small">
        <b>CNT</b> - Counted Points <span class="separator">|</span>
    </span>

    <span class="non-break-small">
        <b>ATT</b> - Attendices <span class="separator">|</span>
    </span>

    <span class="non-break-small">
        <b>AVG</b> - Average <span class="separator">|</span>
    </span>

    <span class="non-break-small">
        <b>BON</b> - Bonus Points <span class="separator">|</span>
    </span>

    <span class="non-break-small">
        <b>PRT</b> - Pretenders Points
    </span>

</div>

<ng-template #loading>
    <app-circle-spinner></app-circle-spinner>
</ng-template>