<div *ngIf="currentPlayer; else loading">

    <app-page-header title="{{'menu.dashboard' | translate}}"
                     subtitle="{{currentPlayer.username}}">
    </app-page-header>

    <div class="row m-1">
        <div class="col-md-4 p-1">
            <mat-card class="mat-elevation-z3 colored-bg-first radius-zero m-0 p-0">
                <mat-card-header class="justify-content-center">
                    <div class="my-awesome-header-small" mat-card-title>{{'match.plural' | translate}}</div>
                </mat-card-header>
                <mat-card-content>
                    <app-css-spinner *ngIf="isSummaryLoading">
                    </app-css-spinner>
                    <app-score-balance *ngIf="playerSummary"
                                       [minus]="playerSummary.scoreboardRow.matchesLost"
                                       [plus]="playerSummary.scoreboardRow.matchesWon">
                    </app-score-balance>
                </mat-card-content>
            </mat-card>
        </div>
        <div class="col-md-4 p-1">
            <mat-card class="mat-elevation-z3 colored-bg-first radius-zero m-0 p-0">
                <mat-card-header class="justify-content-center">
                    <div class="my-awesome-header-small" mat-card-title>{{'set.plural' | translate}}</div>
                </mat-card-header>
                <mat-card-content>
                    <app-css-spinner *ngIf="isSummaryLoading">
                    </app-css-spinner>
                    <app-score-balance *ngIf="playerSummary"
                                       [minus]="playerSummary.scoreboardRow.setsLost"
                                       [plus]="playerSummary.scoreboardRow.setsWon">
                    </app-score-balance>
                </mat-card-content>
            </mat-card>
        </div>
        <div class="col-md-4 p-1">
            <mat-card class="mat-elevation-z3 colored-bg-first radius-zero m-0 p-0">
                <mat-card-header class="justify-content-center">
                    <div class="my-awesome-header-small" mat-card-title>{{'rally.plural' | translate}}</div>
                </mat-card-header>
                <mat-card-content>
                    <app-css-spinner *ngIf="isSummaryLoading">
                    </app-css-spinner>
                    <app-score-balance *ngIf="playerSummary"
                                       [minus]="playerSummary.scoreboardRow.pointsLost"
                                       [plus]="playerSummary.scoreboardRow.pointsWon">
                    </app-score-balance>
                </mat-card-content>
            </mat-card>
        </div>

        <div class="col-md-4 p-1">
            <mat-card class="mat-elevation-z3 colored-bg-second radius-zero m-0 p-0">
                <mat-card-header>
                    <mat-icon color="primary" mat-card-avatar>sports_tennis</mat-icon>
                    <div class="my-awesome-header-small" mat-card-title>{{'league.my' | translate}}</div>
                </mat-card-header>
                <mat-card-content class="m-2">
                    <app-not-found-message *ngIf="currentPlayer.leagueRoles.length === 0"
                                           message="{{'league.notMemberYet' | translate}}">
                    </app-not-found-message>
                    <app-leagues-summary *ngIf="currentPlayer.leagueRoles.length > 0"
                                         [leagueRoles]="currentPlayer.leagueRoles">
                    </app-leagues-summary>
                </mat-card-content>
            </mat-card>
        </div>
        <div class="col-md-4 p-1">
            <mat-card class="mat-elevation-z3 colored-bg-second radius-zero m-0 p-0">
                <mat-card-header>
                    <mat-icon color="primary" mat-card-avatar>bar_chart</mat-icon>
                    <div class="my-awesome-header-small" mat-card-title>{{'me.summary' | translate}}</div>
                </mat-card-header>
                <mat-card-content class="my-awesome-header-tiny">
                    <app-css-spinner *ngIf="isSummaryLoading">
                    </app-css-spinner>
                    <table *ngIf="playerSummary" class="table table-sm table-striped">
                        <tbody>
                        <tr>
                            <td>{{'league.plural' | translate}}</td>
                            <td [countUp]="playerSummary.leagues" [options]="{separator: ' '}">0</td>
                        </tr>
                        <tr>
                            <td>{{'season.plural' | translate}}</td>
                            <td [countUp]="playerSummary.seasons" [options]="{separator: ' '}">0</td>
                        </tr>
                        <tr>
                            <td>{{'round.plural' | translate}}</td>
                            <td [countUp]="playerSummary.rounds" [options]="{separator: ' '}">0</td>
                        </tr>
                        <tr>
                            <td>{{'match.plural' | translate}}</td>
                            <td [countUp]="playerSummary.scoreboardRow.matchesWon + playerSummary.scoreboardRow.matchesLost"
                                [options]="{separator: ' '}">0
                            </td>
                        </tr>
                        <tr>
                            <td>{{'set.plural' | translate}}</td>
                            <td [countUp]="playerSummary.scoreboardRow.setsWon + playerSummary.scoreboardRow.setsLost"
                                [options]="{separator: ' '}">0
                            </td>
                        </tr>
                        <tr>
                            <td>{{'rally.plural' | translate}}</td>
                            <td [countUp]="playerSummary.scoreboardRow.pointsWon + playerSummary.scoreboardRow.pointsLost"
                                [options]="{separator: ' '}">0
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </mat-card-content>
            </mat-card>
        </div>
        <div class="col-md-4 p-1">
            <mat-card class="mat-elevation-z3 colored-bg-second radius-zero m-0 p-0">
                <mat-card-header>
                    <mat-icon color="primary" mat-card-avatar>account_balance</mat-icon>
                    <div class="my-awesome-header-small" mat-card-title>{{'me.info' | translate}}</div>
                </mat-card-header>
                <mat-card-content class="m-2">
                    <table class="table table-borderless table-sm">
                        <tbody>
                        <tr>
                            <td>{{'player.username' | translate}}</td>
                            <td>{{currentPlayer.username}}</td>
                        </tr>
                        <tr>
                            <td>Email</td>
                            <td>{{currentPlayer.email}}</td>
                        </tr>
                        <tr>
                            <td>UUID</td>
                            <td class="small">{{currentPlayer.uuid}}</td>
                        </tr>
                        </tbody>
                    </table>
                </mat-card-content>
            </mat-card>
        </div>

        <div class="col-md-7 p-1">
            <mat-card class="mat-elevation-z3 colored-bg-third radius-zero m-0 p-0">
                <mat-card-header>
                    <mat-icon color="primary" mat-card-avatar>leaderboard</mat-icon>
                    <div class="my-awesome-header-small" mat-card-title>{{'round.lastScoreboard' | translate}}</div>
                </mat-card-header>
                <mat-card-content>

                    <div *ngIf="mostRecentRoundScoreboard">
                        <div class="row p-1 justify-content-center">
                            <div class="col-auto p-2 my-awesome-header-tiny no-wrap">
                                {{mostRecentRoundScoreboard.leagueName}}
                            </div>
                            <div class="col-auto">
                                <button [routerLink]="['/round', mostRecentRoundScoreboard.roundUuid]"
                                        class="me-1"
                                        color="primary"
                                        mat-stroked-button>
                                    {{'round.singular' | translate}} {{mostRecentRoundScoreboard.roundNumber}}
                                </button>
                                <button [routerLink]="['/season', mostRecentRoundScoreboard.seasonUuid]"
                                        class="ms-1"
                                        color="primary"
                                        mat-stroked-button>
                                    {{'season.singular' | translate}} {{mostRecentRoundScoreboard.seasonNumberRoman}}
                                </button>
                            </div>
                        </div>

                        <div class="row g-0">
                            <div class="col">
                                <app-round-group-scoreboard [roundGroupScoreboard]="extractCorrectRoundGroup()">
                                </app-round-group-scoreboard>
                            </div>
                        </div>

                    </div>


                    <app-css-spinner *ngIf="isRoundLoading">
                    </app-css-spinner>

                    <app-not-found-message *ngIf="noRoundsPlayed"
                                           message="{{'round.notPlayedYet' | translate}}">
                    </app-not-found-message>


                </mat-card-content>
            </mat-card>
        </div>

        <div class="col-md-5 p-1">
            <mat-card class="mat-elevation-z3 colored-bg-third radius-zero m-0 p-0">
                <mat-card-header>
                    <mat-icon color="primary" mat-card-avatar>list_alt</mat-icon>
                    <div class="my-awesome-header-small" mat-card-title>{{'round.lastMatches' | translate}}</div>
                </mat-card-header>
                <mat-card-content>


                    <div *ngIf="mostRecentRoundScoreboard">

                        <div class="row p-1 justify-content-center">
                            <div class="col-auto p-2 my-awesome-header-tiny no-wrap">
                                {{mostRecentRoundScoreboard.roundDate | date:'dd.MM.y'}}
                            </div>
                            <div class="col-auto p-2 my-awesome-header-tiny no-wrap">
                                {{'round.singular' | translate}} {{mostRecentRoundScoreboard.roundNumber}}
                            </div>
                        </div>

                        <div class="row g-0">
                            <div class="col">
                                <app-round-group-matches [matches]="extractMyMatches()">
                                </app-round-group-matches>
                            </div>
                        </div>

                    </div>


                    <app-css-spinner *ngIf="isRoundLoading">
                    </app-css-spinner>

                    <app-not-found-message *ngIf="noRoundsPlayed"
                                           message="{{'round.notPlayedYet' | translate}}">
                    </app-not-found-message>


                </mat-card-content>
            </mat-card>
        </div>

        <div class="col-md-4 p-1">
            <mat-card class="mat-elevation-z3 colored-bg-fourth radius-zero m-0 p-0">
                <mat-card-header>
                    <mat-icon color="primary" mat-card-avatar>military_tech</mat-icon>
                    <div class="my-awesome-header-small" mat-card-title>
                        {{'trophy.my' | translate}}
                    </div>
                </mat-card-header>
                <mat-card-content>

                    <app-css-spinner *ngIf="isTrophiesLoading">
                    </app-css-spinner>

                    <app-not-found-message *ngIf="noTrophiesWon"
                                           message="{{'trophy.notWonYet' | translate}}">
                    </app-not-found-message>

                    <div *ngIf="trophies" class="container-fluid">
                        <div *ngFor="let leagueTrophies of trophies" class="row">
                            <div class="col">
                                <div class="row p-1">
                                    <div class="col my-awesome-header-small p-1">
                                        {{leagueTrophies.league.leagueName}}
                                    </div>
                                </div>
                                <div *ngFor="let seasonTrophies of leagueTrophies.trophiesPerSeason" class="row">
                                    <div class="col-5 pb-1 my-awesome-header-tiny no-wrap">
                                        {{'season.singular' | translate}} {{seasonTrophies.seasonNumber}}
                                    </div>
                                    <div *ngFor="let trophy of seasonTrophies.trophies"
                                         class="col-1 pb-1 mx-1 d-flex justify-content-center">
                                        <app-trophy-icon [trophy]="trophy">
                                        </app-trophy-icon>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                </mat-card-content>
            </mat-card>
        </div>

        <div class="col-md-8 p-1">
            <mat-card class="mat-elevation-z3 colored-bg-fourth radius-zero m-0 p-0">
                <mat-card-header>
                    <mat-icon color="primary" mat-card-avatar>sports_kabaddi</mat-icon>
                    <div class="my-awesome-header-small" mat-card-title>{{'league.myScoreboards' | translate}}</div>
                </mat-card-header>
                <mat-card-content>

                    <app-my-matches-stats [currentPlayer]="currentPlayer">
                    </app-my-matches-stats>

                </mat-card-content>
            </mat-card>
        </div>
    </div>

</div>

<ng-template #loading>
    <app-bouncing-balls-loader-sync>
    </app-bouncing-balls-loader-sync>
</ng-template>
